package crypto

import (
	"testing"
)

func TestAsymEncryptionAndDecryption(t *testing.T) {
	var rsaKeys = []struct {
		privateKey string
		publicKey  string
	}{
		{ // Test 2048 key
			`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCu8piKYWnESnnx
kZOCJo9FgTOuKRNncY/QqFYhitAUBtZ0TSq9JL7wvFxQNCiKwWTW7HUI72K5SXJl
0p4axvOxOYmN2Ticegfl/8GIvNMQl6YMiNc9Xm9hxj77hAqEVtl/9cstnaFLMC5f
Plk4J6UD8pmz5lvX1WWtrkMIMnjeap2ioUgNLhyXya25EMLlTDfHVLna2c79Mo8M
aPfZpVIYEqHQJYYBdZGamHMaPuQWmQDFPVvzbsytAxjGSfjDZYHwH9sYrPT51bKq
efMZgBKFUnSsiI0Tx0NbNAJEF+K8t6ZeFfxQUgLKhLmLQjB6cW9OvpPzkS8zErdp
ICUbJrffAgMBAAECggEAQqf36rGW5M0jjSDUPQCIEglaMX9A/2bLTsr0li8XfKnm
R8WnBQ3dGkgKPBzDXaq1yxWoudDLoqETTyxiRP2Ml/e+KyeaZDQykjVR/dFD8cx1
3cy9hYpXkb9A+/+hKi8VC6YQ1b57V/RxlqRgxf6E5u4mFd8tGx0ZcoU00Qi5+LOw
tfSKLPNg4OujraCmrq/bgNkNEiMwHK2AQTbr31uhygUiGTmdXVZu1FLqg7WPGZyZ
x/0U83x0dx6A890OFaebw7I84/tmyJYqutgkK3BhsvIHj1sr34PNdbAMACY/+vqu
r5H7+oCvILlo4pVQ760NBWxIvv6GQGIedH/18GuX4QKBgQDlXxMuyUnUPVXCZWgw
ckvaTXYpQY8om9L4tPeQpQWFhT7pVByQhxIKcmwpAvz5ZhTZUo3ERfuYgheoM6Ay
0AXeuSGagpYWT+rb2DusmDgZIn6wBaMdZX1tll4rNTPOb0rRpQasyJRd6Li9+C9G
A8cRxDKZfiaLSXi2xT45fZuFCQKBgQDDQgugZVGdbIMWJd5KfB7VQbjbkmt+6Q5r
pMY4NMXYCggG1DUuaNwC5Ptl2QE3Z98ZJnYhAvXW0IaD7OyjqOItA00Q4+v8nv/I
Bu5hCtIFHx+xCQtWL8IApjTckmen8YmFNBSgQHsCBR7oR51orgHu9HsPcTh5Jq5V
oBr67a43pwKBgQCIYTJvtCFgv6NZNaBwhdUSFNK4DxIGzDfxxvAYIfaZgDN62pct
XBJfAc/LxsoRpB+rZAmE9TN2Z4uXaDLNY6DJ3/vZ+eExnQ0A8J3yroNUdo0rLf7h
gLHGUgzl1flauhObeWrxm0WUXMZTtdit4Zsgti5702UplmLfEYJA/q1UuQKBgBbb
jHDia4N6SH43QKaHkTR11SYfJeZdcgq351x9EQwRYI8sGG2uaNMN60Ao/zN1PXC8
R+flaNIU5ypaeflOs+uBD2yCwgV4t4i7BvzlP2DKG/Olk2YrgRKCYn3PxcKrS+YE
CsYXxk6eOtgGSi8O77sBc8aDApFsLcxoScBGQrbRAoGANZKkKXpe7kNn05Td5JMY
QchqRD9x1z/8zyWSnwpRlfUG3RnRRqyv14gHK1sTaIcb6hTKkcUnoP6cBQZOR8wQ
b9jhi/YwGgMbC7wI11l70vJzf1ydKfI0JeGy51UP/8bCw8sAf67z/S7nwWZBUsrM
X3wz+2TeAgQK0jsLzrv0R8A=
-----END PRIVATE KEY-----`,
			`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArvKYimFpxEp58ZGTgiaP
RYEzrikTZ3GP0KhWIYrQFAbWdE0qvSS+8LxcUDQoisFk1ux1CO9iuUlyZdKeGsbz
sTmJjdk4nHoH5f/BiLzTEJemDIjXPV5vYcY++4QKhFbZf/XLLZ2hSzAuXz5ZOCel
A/KZs+Zb19Vlra5DCDJ43mqdoqFIDS4cl8mtuRDC5Uw3x1S52tnO/TKPDGj32aVS
GBKh0CWGAXWRmphzGj7kFpkAxT1b827MrQMYxkn4w2WB8B/bGKz0+dWyqnnzGYAS
hVJ0rIiNE8dDWzQCRBfivLemXhX8UFICyoS5i0IwenFvTr6T85EvMxK3aSAlGya3
3wIDAQAB
-----END PUBLIC KEY-----`,
		},
		{ // Test 3072 key
			`-----BEGIN PRIVATE KEY-----
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
RGJNCu8EOLaRCIFBcbA7AZgALQ==
-----END PRIVATE KEY-----`,
			`-----BEGIN PUBLIC KEY-----
MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEA3z8f7MYtqU1iDBGuibqC
7AbtK8zwI2eIdqbZo+znsX4WXlN5Su9Iyrf7deaNgy/rj5O6H0HdNYXTg89NOe3A
fJjb+z6TXdeF0dfwfIhOdTRtURVesr1b56BpbWcekLlCULe+6lFwC/zLpvXMZrCc
7ui8i1pRzdczKLat9GNvFsb+v5xR+rNjzcKTSHQFtstOenOoS3TC0xAgXEEzqkFN
VbGgsC7Y9Gmzcj5Q5okWEsX7XP/Cn4xK9nQpBF0+wLOl/7fRXIEdGHV1c5awfD7l
rgWVR+GY+R9cMcnX/Nk1hgeyI0+W6UtAHmVYNxoc0tvYCbV3/+FmHVFntlr8Uws+
KdheIKdUG+Ouv+vMTeAYOw9+5OGainDWFJA3LZHid3qbX85Y0as9n1nSKoYXMMQT
88Nx+U7Vv8fTudHUgueYGy7WtE6URRIkI5W94u5jDpcb9DZ90Wv5XhaJdRmQ2BhZ
pCVg892PjJwMcTWhIKJgX+9QEL2bSb2VY3yEpEa2b2LhAgMBAAE=
-----END PUBLIC KEY-----`,
		},
		{ // Test 4096 key
			`-----BEGIN PRIVATE KEY-----
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
kGdh/czrBuFnI2cSVhf1a6zneO+JNCQ=
-----END PRIVATE KEY-----`,
			`-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAvpTPD513rsPExOskQhqI
28urp4UVS94hBZ1JfFuUmV4smuXW6Hdc6Gp1xkXvoYMH1suKV0jj219Am9xInxxT
3bGXPpletlxnhgQcU4LbVH5jeuudmK+D+uTvld3qD3hGTDJ72jlRWljGYhUxSmQc
EHPzpaUaPQnUH4Y7bs7USo05Ur7MbB+O3Drb7jgHlApeZUJ0Xq9Wc4sIqKYREp7w
u30KzpfnwyLYh9hzKdcsicRbBR4jvniLr9v0I5s/YhxvH0fYF02SA876qYkGZOL+
cSz0UGNZpDksSeo8NkpjaeOHQJfvqXRBte19seH4w+ssF8qYUQhbWST4VTsQbNh1
I/rFrg32L9+UgD8+Si1X5yMebn8CULU7rjRVTMg5YFFRTIGXZX/aYtfSnSK5QRtz
zCP3j0xZSAYJwJoGoNggHXUTQERqPHwImpCOdD0Ufih6StvGpNyUe5w7YIfdtoOa
Td+sCeVX1dczquJziOvYwCyC4nM7pY+13+DXgszMydj/jdSshM4p2GRQu/JYDJf+
7G/BVRcgCaPpBwOp6EYLtiaOAQTUg7nE32eM4A31Ip+KIaO6g9sMqHl/qc4IGnSh
EfNOjyrEL5+gjYgiQzVVbYkRhr2ZNeNvzdQsM8j+I20ObCNY1RFCmp9//8xNbi1k
ufgiB73q6Fnh5QHf1HNAeMUCAwEAAQ==
-----END PUBLIC KEY-----`,
		},
		{ // Test certificate
			`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDNxPq9JCuazKAB
0s+xTVqN2kiyDQ1OpJG08yQ7efnd5yinEyxesr008UvCo5+G5AKMbmajAY/weiry
o2G4UVt37TyH0ODkAFS3dVDkLfh2MnwAXSppOadav1XRiYqGYjPPMRUJe/ueNewx
XhknUm1Bn5EXgUnMS2V0XmZdAN0Fn1DxTKZvuPa50be0G+uRDWw+ZVFg1MDPt7TO
/TScQx6ytIgfRbUMqC8dM9aVHOyfUvbdM39ZNjbyZIERSuMZJHOZdx28n7gfiScQ
3ZqgDFQPRm0J6GDCkeXTjElD63X4P3qgrWVzAPZPuvdBiaQlfs+YQtjB345Tgg+B
YJN/Kre5AgMBAAECggEABBDjX39qeSmX89FFl1xO8MSicRo+7BHmayvuyFoVrOPX
cs23L7vab0RhWdw/17uDrWC1GH18aaUQWjEOSkUZSJpgetKOzxKOmf1wdsHNyhAf
USaGIwQnoWxsdrKAET25hluS7dgMVcj8/NC+MH+5dvV/OXatjaLjw1PmM+pDc8v0
DAGEO198w/gADYli8dQdrwFHWacklKURRhONTSXNvFmGZwB2OcrAQ+Flu5C6zAUt
zaE+orLYUcvZvW5UjTABZ8yEQASsNh0mGddCMgKwidSG1grFrgHy3QmpJfiWR04T
RdUJAr6si3+7/j3gXpd+aHvPcBYOrICWY8zYShr/gQKBgQDqGIsc3jHNBk8R0QCh
f9FIDpXnZCLppsi3vxSkvR1fQgaNJfhg8OsZWyBaNO0gc0GgvUxsr2Yq6EzA6qZB
86hCw2ykl2zWtMV+pihuxiyPsEX6GeI0ojgc5881H0yosw3HWOGQIxtq/j6xs4Kv
CKmAsjqKMYTlERZq/mB/ACtEUQKBgQDhBeoD9NIOueHtV6cnbiJXXOO0hvnARUWX
B3FIw9isoUIYIHhg6Fhz7aIXkIcaG9zJnAnQDiQPE1mru+FSXbb7sqvF8DwgUpNh
c1Wu3KoWG/ll+cm8epFb//8RcsHwrU2oOn2U6SniqQEEhY11g6fXTfiB+2aR0nri
tJKLtYBq6QKBgQCqoudMTJ5qf03Fg9582imX56HXQAO+4ubuISeQCZXOaNdTrbjG
GPaVzfngJzIt9DWDUFjT5GqJnjjMan50FoKw37hipUodmzlWXxGb5XJ37pqjepiL
my9hyoscgssjMRk7FQueQCjtLZRPfbUllx/PAptvPjdLrc/0f6WhDWN8cQKBgBH/
oRoz6OFYqOONEUesHX8TZPs5mJxybgCIjd0eHSShuWGopzhJHVoYddCgtM230M8n
dfl4SBYUnCWKX5lw+YPkZKzubEDBmhw/V2knKUufbTFk62fx/dJ4BXTl0vFnS0Db
fNP+WmVQ004DSK9Pmos0J15uN2QOi9m6S8Z0/BKRAoGAPXVuUCakXJucjorc2Rnn
TC4h73nhw127gNHT//V0Xok9PQkfCLyppPlhpSMQJ7IaMwIL28c4I/611CHDU8jb
KjNDoTuL3yRqOQNz1zLub5m/+vti4+Sh0//kT5G1SjL7BWSxtGt7EvQiM6rxgihP
Px0iQ2RGtzRV2ejyvAouYos=
-----END PRIVATE KEY-----`,
			`-----BEGIN CERTIFICATE-----
MIIDazCCAlOgAwIBAgIUUySK3aFhC08WO9hOMq19tFurxeUwDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yMzEyMTIxODQzNDZaFw0yNDEy
MTExODQzNDZaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQDNxPq9JCuazKAB0s+xTVqN2kiyDQ1OpJG08yQ7efnd
5yinEyxesr008UvCo5+G5AKMbmajAY/weiryo2G4UVt37TyH0ODkAFS3dVDkLfh2
MnwAXSppOadav1XRiYqGYjPPMRUJe/ueNewxXhknUm1Bn5EXgUnMS2V0XmZdAN0F
n1DxTKZvuPa50be0G+uRDWw+ZVFg1MDPt7TO/TScQx6ytIgfRbUMqC8dM9aVHOyf
UvbdM39ZNjbyZIERSuMZJHOZdx28n7gfiScQ3ZqgDFQPRm0J6GDCkeXTjElD63X4
P3qgrWVzAPZPuvdBiaQlfs+YQtjB345Tgg+BYJN/Kre5AgMBAAGjUzBRMB0GA1Ud
DgQWBBTV1245NzOOCFSsUwWAsKdC/9fEnDAfBgNVHSMEGDAWgBTV1245NzOOCFSs
UwWAsKdC/9fEnDAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQAU
mJ6wTM0nlDfewYSOl6vkVHwL1LIXVEPnBhAAa3Hax9wtvUK+Tbg+7D3l7/Iq5Y/+
UsHa/BQ9lktj/v2DAsaTVcO33IIyPrz1NCzB44hv+3G5HzUwKgDTY5tN8SCmy+Ti
rx3c0AOqCfpKmuRhzYLbaHjbj7jwCzdelJr318x2dVOGXB5J1yWQ3TfKKicWqA+9
pDtPNFJ3M79YVI+84gUN6YAeM0edJWOpZRoxui3DvzINVAd3W+p3v+HYc6d+SRTw
Ac3Yy7hVSJCQjkgYm4dWNDSWFFz5TYkASjQiXhEyvofS37lf6p6qm77CAr/xfdKx
rfa3TMt0K2Gs502yHMD4
-----END CERTIFICATE-----`,
		},
	}

	for _, test := range rsaKeys {
		asymEncryptor, err := NewAsymEncryption(test.publicKey)
		if err != nil {
			t.Fatalf("NewAsymEncryption - failed: %v", err)
		}

		plainText := "virtru"
		cipherText, err := asymEncryptor.Encrypt([]byte(plainText))
		if err != nil {
			t.Fatalf("AsymEncryption encrypt failed: %v", err)
		}

		asymDecryptor, err := NewAsymDecryption(test.privateKey)
		if err != nil {
			t.Fatalf("NewAsymDecryption - failed: %v", err)
		}

		decryptedText, err := asymDecryptor.Decrypt(cipherText)
		if err != nil {
			t.Fatalf("AsymDecryption decrypt failed: %v", err)
		}

		if string(decryptedText) != plainText {
			t.Error("Asym encrypt/decrypt failed")
		}
	}
}
