syntax = "proto3";

package policy.obligations;

import "common/common.proto";
import "policy/objects.proto";
import "google/protobuf/struct.proto";

///
/// Obligation
///

// Definitions
message GetObligationRequest {
    // Required
    string id = 1;
}

message GetObligationResponse {
    policy.Obligation obligation = 1;
}

message CreateObligationRequest {
    // Required
    string namespace_id = 1;
    string name = 2;
    // Optional
    // Common metadata
    common.MetadataMutable metadata = 100;
}

message CreateObligationResponse {
    policy.Obligation obligation = 1;
}

// Values
message CreateObligationValueRequest {
    // Required
    string obligation_id = 1;
    string value = 2;
    // Optional
    // Common metadata
    common.MetadataMutable metadata = 100;
}

// Triggers
message AddObligationTriggerRequest {
    // Required
    string obligation_value_id = 1;
    string action_id = 2;
    string attribute_value_id = 3;
    // Optional
    // Common metadata
    common.MetadataMutable metadata = 100;
}

// Fulfillers
message AddObligationFulfillerRequest {
    // Required
    string obligation_value_id = 1;
    google.protobuf.Struct conditionals = 2;
    // Optional
    // Common metadata
    common.MetadataMutable metadata = 100;
}