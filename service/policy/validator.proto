edition = "2023";

package policy;

import "buf/validate/validate.proto";

extend buf.validate.StringRules {
  bool optional_uuid = 70000001 [
    (buf.validate.predefined).cel = {
      id: "uuid_format",
      message: "field must be a valid UUID",
      expression: "size(this) == 0 || this.matches('[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}')"
    }
  ];
}
